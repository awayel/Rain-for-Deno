import{A as T,d as B,p as N}from"./product-tree.8a1c6166.js";import{_ as g,$ as d,v as O,h}from"./index.4a9bdc9c.js";import{_ as R}from"./base-ant-drawer.41d9aad8.js";import{c as f}from"./time-encapsulate.82ba6042.js";import{d as _,l as k,a4 as x,o as F,f as w,v as l,x as p,u as s,m as o,w as I,j as A,aa as U}from"./vendor.69bb0da0.js";const $={class:"title"},P={class:"table-ul"},V=_({props:{treeData:null},setup(m){const u=m,e=k({tableLoading:!1,tableData:[],title:"",total:0,productId:"",systemCode:"",terminalCode:"",type:"REPORT",info:"",drawerTitle:"\u7248\u672C\u63D0\u4EA4",drawerVisible:!1,btnloading:!1,productStage:2,activeKey:2,actionColums:[{type:"DETAILS",title:"\u7248\u672C\u8BE6\u60C5",key:"MENU-20220324092606-FLO5M8"},{type:"ACCESS",title:"\u5730\u5740\u8BBF\u95EE",key:"MENU-20220324092606-FLO5M8"},{type:"PASS",title:"\u5BA1\u6838\u901A\u8FC7",key:"MENU-20220324092606-FLO5M8"},{type:"REJECTED",title:"\u5BA1\u6838\u9A73\u56DE",key:"MENU-20220324092606-FLO5M8"}]});x(()=>u.treeData,(t,a)=>{t&&(e.systemCode=t.systemCode,e.terminalCode=t.code,e.terminalCode=="WEB"?e.actionColums=[{type:"DETAILS",title:"\u7248\u672C\u8BE6\u60C5",key:"MENU-20220324092606-FLO5M8"},{type:"ACCESS",title:"\u5730\u5740\u8BBF\u95EE",key:"MENU-20220324092606-FLO5M8"},{type:"PASS",title:"\u5BA1\u6838\u901A\u8FC7",key:"MENU-20220324092606-FLO5M8"},{type:"REJECTED",title:"\u5BA1\u6838\u9A73\u56DE",key:"MENU-20220324092606-FLO5M8"},{type:"RELEASE",title:"\u7248\u672C\u53D1\u5E03",key:"MENU-20220324092606-FLO5M8"}]:e.actionColums=[{type:"DETAILS",title:"\u7248\u672C\u8BE6\u60C5",key:"MENU-20220324092606-FLO5M8"},{type:"DOWNLOAD",title:"\u7248\u672C\u4E0B\u8F7D",key:"MENU-20220324092606-FLO5M8"},{type:"PASS",title:"\u5BA1\u6838\u901A\u8FC7",key:"MENU-20220324092606-FLO5M8"},{type:"REJECTED",title:"\u5BA1\u6838\u9A73\u56DE",key:"MENU-20220324092606-FLO5M8"},{type:"RELEASE",title:"\u7248\u672C\u53D1\u5E03",key:"MENU-20220324092606-FLO5M8"}],C())},{immediate:!0,deep:!0});const r=f("product-version"),b=f("product-info"),E=U(),C=()=>{d({method:b.Detail,data:{systemCode:e.systemCode,terminalCode:e.terminalCode},success:t=>{t.data?(e.productId=t.data.productInfo.id,c()):(e.tableData=[],e.total=0)}})},S=()=>{window.open("http://61.185.217.246:24180/zentaopms/www/index.php?m=user&f=login")},n=t=>{e.activeKey=t,c()},c=()=>{e.tableLoading=!0;const t=E==null?void 0:E.refs.antTableRef,a={},i=t.getCurrentSize();a.versionStatus=e.activeKey,a.current=i.current,a.size=i.size,a.productId=e.productId,d({method:r.Page,data:a,success:v=>{e.total=v.count,e.tableData=v.lists,e.tableLoading=!1}})},D=t=>{switch(t){case"close":e.drawerVisible=!1;break;case"save":e.drawerVisible=!1,C();break}},L=t=>{const a=t.type;switch(e.type=a,a){case"ADD":e.drawerVisible=!0;break;case"SEARCH":c();break;case"DETAILS":e.info=t.data,e.drawerVisible=!0;break;case"PASS":y(t.data,4);break;case"REJECTED":y(t.data,3);break;case"ACCESS":window.open(t.data.versionPath);break;case"DOWNLOAD":d({method:O,data:{id:t.data.id,productSecret:""},success:i=>{window.location.href=i.data},fail:i=>{A.warning({message:i.message})}});break;case"RELEASE":y(t.data,5);break}},y=(t,a)=>{d({method:h,data:{id:t.id,status:a},success:i=>{A.success({message:"\u64CD\u4F5C\u6210\u529F"}),C()}})},M=[{title:"\u7248\u672C\u540D\u79F0",ellipsis:!0,dataIndex:"versionName",align:"center"},{title:"\u7248\u672C\u53F7",ellipsis:!0,dataIndex:"versionNo",align:"center"},{title:"\u53D1\u5E03\u4EBA\u5458",ellipsis:!0,dataIndex:"createdName",align:"center"},{title:"\u6D4B\u8BD5\u4EBA\u5458",ellipsis:!0,dataIndex:"receiverName",align:"center"},{title:"\u64CD\u4F5C",dataIndex:"remarks",key:"a.remarks",width:180,align:"center",fixed:"right",slots:{customRender:"action"}}];return(t,a)=>(F(),w("div",null,[l("div",$,[l("ul",P,[l("li",{class:p(["table-li",s(e).activeKey==2?"table-li-active":""]),onClick:a[0]||(a[0]=i=>n(2))}," \u7248\u672C\u6D4B\u8BD5 ",2),l("li",{class:p(["table-li",s(e).activeKey==3?"table-li-active":""]),onClick:a[1]||(a[1]=i=>n(3))}," \u7248\u672C\u9A73\u56DE ",2),l("li",{class:p(["table-li",s(e).activeKey==4?"table-li-active":""]),onClick:a[2]||(a[2]=i=>n(4))}," \u7248\u672C\u901A\u8FC7 ",2),l("li",{class:p(["table-li",s(e).activeKey==5?"table-li-active":""]),onClick:a[3]||(a[3]=i=>n(5))}," \u7248\u672C\u53D1\u5E03 ",2)]),l("a",{style:{},onClick:S},"\u9879\u76EE\u6D4B\u8BD5\uFF0C\u7985\u9053\u5165\u53E3 >>>")]),o(T,{loading:s(e).tableLoading,tableData:s(e).tableData,title:s(e).title,class:"ant-table",total:s(e).total,tableColumns:M,pagination:!0,expandedRowRende:!0,style:{height:"calc(100% - 69px)",display:"block"},ref:"antTableRef",actionColums:s(e).actionColums,onOperation:L,onRefresh:c},null,8,["loading","tableData","title","total","actionColums"]),o(R,{drawerTitle:s(e).drawerTitle,destroyOnClose:!0,footerVisible:!1,visible:s(e).drawerVisible,loading:s(e).btnloading,onDrawerFun:D},{drawerForm:I(()=>[o(B,{ref:"reportRef",onDrawerFun:D,type:s(e).type,info:s(e).info,treeData:u.treeData,class:"debugging-report"},null,8,["type","info","treeData"])]),_:1},8,["drawerTitle","visible","loading"])]))}});var z=g(V,[["__scopeId","data-v-5043c989"]]);const K={style:{height:"100%",display:"flex"}},J=_({setup(m){const u=k({selectTreeData:""}),e=r=>{r.systemName?u.selectTreeData=r:u.selectTreeData=""};return(r,b)=>(F(),w("div",K,[o(N,{onSelectTree:e}),o(z,{class:"verification-table",treeData:s(u).selectTreeData},null,8,["treeData"])]))}});var Q=g(J,[["__scopeId","data-v-d00acaa6"]]);export{Q as default};
