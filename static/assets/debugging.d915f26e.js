var F=Object.defineProperty;var I=Object.getOwnPropertySymbols;var V=Object.prototype.hasOwnProperty,L=Object.prototype.propertyIsEnumerable;var x=(s,t,e)=>t in s?F(s,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):s[t]=e,C=(s,t)=>{for(var e in t||(t={}))V.call(t,e)&&x(s,e,t[e]);if(I)for(var e of I(t))L.call(t,e)&&x(s,e,t[e]);return s};import{_ as h,$ as A}from"./index.4a9bdc9c.js";import{_ as $}from"./base-ant-drawer.41d9aad8.js";import{c as E}from"./time-encapsulate.82ba6042.js";import{A as O,d as P,p as z}from"./product-tree.8a1c6166.js";import{d as S,r as R,a as p,o as v,f as T,m as a,w as l,u as n,ab as U,s as k,l as B,a4 as H,v as N,c as M,ac as Q,b as j,Q as q,R as G,aa as J}from"./vendor.69bb0da0.js";const K={class:"table-search"},W=k(" \u641C\u7D22 "),X=S({props:{type:null},emits:["operation"],setup(s,{expose:t,emit:e}){const r=R({versionNo:"",versionStatus:2}),b=R([{value:2,label:"\u6D4B\u8BD5\u4E2D"},{value:3,label:"\u9A73\u56DE"},{value:4,label:"\u901A\u8FC7"}]),u=()=>{e("operation",{type:"SEARCH"})};return t({getSearchData:()=>C({},r.value)}),(D,i)=>{const f=p("a-input"),m=p("a-form-item"),g=p("a-col"),y=p("a-select"),o=p("a-button"),c=p("a-row"),d=p("a-form");return v(),T("div",K,[a(d,{ref:"formRef",model:r.value},{default:l(()=>[a(c,{gutter:16},{default:l(()=>[a(g,{span:6},{default:l(()=>[a(m,{label:"\u7248\u672C\u53F7"},{default:l(()=>[a(f,{value:r.value.versionNo,"onUpdate:value":i[0]||(i[0]=_=>r.value.versionNo=_)},null,8,["value"])]),_:1})]),_:1}),a(g,{span:6},{default:l(()=>[a(m,{label:"\u7248\u672C\u72B6\u6001"},{default:l(()=>[a(y,{value:r.value.versionStatus,"onUpdate:value":i[1]||(i[1]=_=>r.value.versionStatus=_),placeholder:"\u7248\u672C\u72B6\u6001",options:b.value,onChange:u},null,8,["value","options"])]),_:1})]),_:1}),a(o,{type:"primary",onClick:u},{icon:l(()=>[a(n(U))]),default:l(()=>[W]),_:1})]),_:1})]),_:1},8,["model"])])}}});var Y=h(X,[["__scopeId","data-v-829689fc"]]);const Z=s=>(q("data-v-6160bc82"),s=s(),G(),s),ee={style:{height:"100%"}},te={class:"title"},ae=Z(()=>N("span",null,"\u4EA7\u54C1\u7248\u672C",-1)),oe=k("\u6DFB\u52A0 "),se=S({props:{treeData:null},setup(s){const t=s,e=B({tableLoading:!1,tableData:[],title:"",total:0,productId:"",systemCode:"",terminalCode:"",drawerTitle:"\u7248\u672C\u63D0\u4EA4",type:"REPORT",info:"",drawerVisible:!1,btnloading:!1,productStage:2});H(()=>t.treeData,(o,c)=>{o&&(e.systemCode=o.systemCode,e.terminalCode=o.code,D())},{immediate:!0,deep:!0});const r=E("product-version"),b=E("product-info"),u=J(),D=()=>{A({method:b.Detail,data:{systemCode:e.systemCode,terminalCode:e.terminalCode},success:o=>{o.data?(e.productId=o.data.productInfo.id,i()):(e.tableData=[],e.total=0)}})},i=()=>{e.tableLoading=!0;const o=u==null?void 0:u.refs.antTableRef,c=u==null?void 0:u.refs.tableSearch,d=C({},c.getSearchData()),_=o.getCurrentSize();d.current=_.current,d.size=_.size,d.productId=e.productId,A({method:r.Page,data:d,success:w=>{e.total=w.count,e.tableData=w.lists,e.tableLoading=!1}})},f=o=>{switch(o){case"close":e.drawerVisible=!1;break;case"save":e.drawerVisible=!1,D();break}},m=o=>{debugger;switch(o.type){case"ADD":e.type="REPORT",e.drawerVisible=!0;break;case"SEARCH":i();break;case"DETAILS":e.type="DETAILS",e.info=o.data,e.drawerVisible=!0}},g=[{title:"\u7248\u672C\u540D\u79F0",ellipsis:!0,dataIndex:"versionName",align:"center"},{title:"\u7248\u672C\u53F7",ellipsis:!0,dataIndex:"versionNo",align:"center"},{title:"\u53D1\u5E03\u4EBA\u5458",ellipsis:!0,dataIndex:"createdName",align:"center"},{title:"\u6D4B\u8BD5\u4EBA\u5458",ellipsis:!0,dataIndex:"receiverName",align:"center"},{title:"\u64CD\u4F5C",dataIndex:"remarks",key:"a.remarks",width:180,align:"center",fixed:"right",slots:{customRender:"action"}}],y=[{type:"DETAILS",title:"\u7248\u672C\u8BE6\u60C5",key:"MENU-20220324092606-FLO5M8"}];return(o,c)=>{const d=p("a-button");return v(),T("div",ee,[N("div",te,[ae,t.treeData.rootNode==0?(v(),M(d,{key:0,type:"primary",onClick:c[0]||(c[0]=_=>m({type:"ADD"}))},{default:l(()=>[a(n(Q)),oe]),_:1})):j("",!0)]),a(Y,{ref:"tableSearch",onOperation:m},null,512),a(O,{loading:n(e).tableLoading,tableData:n(e).tableData,title:n(e).title,total:n(e).total,tableColumns:g,pagination:!0,class:"ant-table",expandedRowRende:!0,style:{height:"calc(100% - 130px)",display:"block"},ref:"antTableRef",actionColums:y,onOperation:m,onRefresh:i},null,8,["loading","tableData","title","total"]),a($,{drawerTitle:n(e).drawerTitle,destroyOnClose:!0,footerVisible:!1,onDrawerFun:f,visible:n(e).drawerVisible,loading:n(e).btnloading},{drawerForm:l(()=>[a(P,{ref:"reportRef",onDrawerFun:f,type:n(e).type,info:n(e).info,treeData:t.treeData,class:"debugging-report"},null,8,["type","info","treeData"])]),_:1},8,["drawerTitle","visible","loading"])])}}});var re=h(se,[["__scopeId","data-v-6160bc82"]]);const ne={style:{height:"100%",display:"flex"}},le=S({setup(s){const t=B({selectTreeData:""}),e=r=>{r.systemName?t.selectTreeData=r:t.selectTreeData=""};return(r,b)=>(v(),T("div",ne,[a(z,{onSelectTree:e}),a(re,{class:"debugging-report",treeData:n(t).selectTreeData},null,8,["treeData"])]))}});var me=h(le,[["__scopeId","data-v-045fb1d3"]]);export{me as default};
